{{- if and (or .Values.controllers.cronjob.enabled .Values.controllers.job.enabled) .Values.rbac.create }}
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ if .Values.rbac.serviceAccountName }}{{ .Values.rbac.serviceAccountName }}{{ else }}{{ include "cnpg-backup.fullname" . }}{{ end }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "cnpg-backup.labels" . | nindent 4 }}
  annotations:
    description: "Service account for CNPG backup and restore jobs"
{{- end }}